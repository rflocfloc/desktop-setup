---
- name: "conda: Download miniforge_conda binary"
  ansible.builtin.get_url:
    url: "{{ conda_url }}"
    dest: "~/Downloads/Miniforge3.sh"
    mode: '755'

- name: "conda: Install miniforge-conda"
  ansible.builtin.shell:
    cmd: "bash ~/Downloads/Miniforge3.sh -b -u -p {{ conda_path }}"

- name: "conda: Remove auto generated condarc"
  ansible.builtin.file:
    path: "~/.condarc"
    state: absent

- name: "conda: Remove miniforge_conda binary"
  ansible.builtin.file:
    path: "~/Downloads/Miniforge3.sh"
    state: absent

- name: "conda: Source bashrc"
  ansible.builtin.shell:
    cmd: "source ~/.bashrc"
  args:
    executable: /bin/bash
